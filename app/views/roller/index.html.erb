<%= stylesheet_link_tag "roller" %>
<%= javascript_import_module_tag "roller" %>

<div id="roller-wrapper">
  <h1>Dice Roller</h1>

  <div id="roller-window">
    <div id="roller-controls">
      <div id="roller-control-panel">
        <button id='view-rolls-button'>
          <a id="view-rolls-link" href='/rolls'>Roll History</a>
        </button>
        <%= form_tag("/roll", id: "roll-form", local: true) do %>
        <%# 
          Loop through possible types of dice and list a radio for each.
          When the page loads or redirecting to this page, D20 should be the 
          default selection. Otherwise if you're rolling, the currently selected
          type should remain when the page updates. %>
          <% @die_types.each do |d| %>
            <%= radio_button_tag(
              :type,
              d,
              (
                flash[:radio_selection] == d ||
                  (flash[:radio_selection] == nil && d == "D20")
              )
            ) %>
            <%= label_tag("type_#{d}", d) %>
            <br>
          <% end %>
          <%= label_tag(:info, "Optional Info:") %><br>
          <%= text_field_tag(:info) %>
          <br>
          <%= submit_tag("Roll", id: "roll-button") %>
        <% end %>
      </div>
    </div>

    <%= content_tag(:canvas, "", data: { controller: "threejs" }, id: "three-canvas") %>
    <div id="three-main"></div>
  </div>
</div>

<%# Show the roll result if there is one to show %>
<div id="roll-result-container">
  <% if flash[:roll_result] %>
    <div id="results-background">
      <div id='roll-result'>Roll Result:
        <%= flash[:roll_result] %>
      </div>
      <% if flash[:info] != "" %>
        <div id='roll-result-info'>Info:
          <%= flash[:info] %>
        </div>
      <% end %>
      <div id='roll-result-info'>Type:
        <%= flash[:radio_selection] %>
      </div>
    </div>

  <% end %>
</div>
